The code has been refactored.